当归芍药散组方药味关联规律的数据挖掘研究
许　
钒
1�2　
彭代银
2　
余伯阳
1＃
　
许　
钒�男�在读博士生�副教授
（1中国药科大学中药复方研究室　
江苏210038；2安徽中医学院药学院）
摘要：目的　
研究当归芍药散组方药味关联规律�为进一步研究当归芍药散组方原理提供基础。
方法　
通过检索中药方剂数据库中与当归芍药散组方药味有关的方剂�构建当归芍药散药味配伍
数据库�运用神经网络、决策树、关联规则、聚类分析等数据挖掘技术�利用ＳＰＳＳＣｌｅｍｅｎｔｉｎｅ和ＳＰＳＳ
软件�研究其组方药味之间的关联规律。结果　
相互支持度�当归对芍药、芍药对当归为强支持�茯
苓对白术、川芎对当归、当归对川芎、白术对茯苓、泽泻对茯苓为较强支持；对全方的贡献度�当归＞
茯苓＞芍药＞川芎＞白术＞泽泻；聚类分析表明泽泻对当归芍药散全方关联最强。结论　
在当归
芍药散组成中�当归、茯苓和芍药为主要成分�泽泻为特征成分�川芎、白术在其中发挥重要作用。
关键词：当归芍药散；组方；药味；关联规律；数据挖掘
中图分类号：Ｒ2-03
ＤａｔａｍｉｎｉｎｇｉｎｒｅｌａｔｉｖｅｒｕｌｅｓａｍｏｎｇｉｎｇｒｅｄｉｅｎｔｓｏｆＤａｎｇｇｕｉｓｈａｏｙａｏＰｏｗｄｅｒ
ＸＵＦａｎ
1�2�ＰＥＮＧＤａｉ-ｙｉｎ
2�ＹＵＢｏ-ｙａｎｇ
1＃
（1ＲｅｓｅａｒｃｈＲｏｏｍｏｆＣｈｉｎｅｓｅＣｏｍｐｏｕｎｄＦｏｒｍｕｌａｓ�ＣｈｉｎａＰｈａｒｍａｃｅｕｔｉｃａｌＵｎｉｖｅｒｓｉｔｙ�Ｊｉａｎｇｓｕ　
210038；
2ＳｃｈｏｏｌｏｆＰｈａｒｍａｃｙ�ＡｎｈｕｉＣｏｌｌｅｇｅｏｆＣｈｉｎｅｓｅＭｅｄｉｃｉｎｅ）
Ａｂｓｔｒａｃｔ：Ｏｂｊｅｃｔｉｖｅ　
ＴｏｓｔｕｄｙｔｈｅｒｅｌａｔｉｖｅｒｕｌｅｓａｍｏｎｇｔｈｅｉｎｇｒｅｄｉｅｎｔｓｏｆＤａｎｇｇｕｉｓｈａｏｙａｏＰｏｗｄｅｒａｎｄ
ｐｒｏｖｉｄｅａｂａｓｉｓｆｏｒｆｕｒｔｈｅｒｒｅｓｅａｒｃｈ．Ｍｅｔｈｏｄ　
ＴｈｅｒｅｌａｔｉｖｅｒｕｌｅｓａｍｏｎｇｔｈｅｉｎｇｒｅｄｉｅｎｔｓｏｆＤａｎｇｇｕｉｓｈａｏｙａｏ
Ｐｏｗｄｅｒｗｅｒｅｓｔｕｄｉｅｄｂｙａｐｐｌｙｉｎｇｄａｔａｍｉｎｉｎｇｔｅｃｈｎｏｌｏｇｙ�ｉｎｃｌｕｄｉｎｇｎｅｕｒａｌｎｅｔｗｏｒｋｓ�ｄｅｃｉｓｉｏｎｔｒｅｅ�
ａｓｓｏｃｉａｔｉｏｎｒｕｌｅｓａｎｄｃｌｕｓｔｅｒｉｎｇａｎａｌｙｓｉｓ�ａｎｄｓｏｆｔｗａｒｅｏｆＳＰＳＳＣｌｅｍｅｎｔｉｎｅａｎｄＳＰＳＳ．Ｔｈｅｄａｔａｂａｓｅｏｆ
ｉｎｇｒｅｄｉｅｎｔｃｏｍｂｉｎａｔｉｏｎｓｏｆＤａｎｇｇｕｉｓｈａｏｙａｏＰｏｗｄｅｒｗａｓｅｓｔａｂｌｉｓｈｅｄｔｈｒｏｕｇｈｒｅｔｒｉｅｖｉｎｇｔｈｅｆｏｒｍｕｌａｓｒｅｌａｔｅｄｔｏ
ｔｈｅｉｎｇｒｅｄｉｅｎｔｓｏｆＤａｎｇｇｕｉｓｈａｏｙａｏＰｏｗｄｅｒｆｒｏｍｔｈｅＤａｔａｂａｓｅｏｆＣｈｉｎｅｓｅＦｏｒｍｕｌａｓ．Ｒｅｓｕｌｔ　
Ｉｎｔｈｅａｓｐｅｃｔｏｆ
ｍｕｔｕａｌｓｕｐｐｏｒｔｒａｔｉｎｇ�ＲａｄｉｘＡｎｇｅｌｉｃａｅＳｉｎｅｎｓｉｓｔｏＲａｄｉｘＰａｅｏｎｉａｅＡｌｂａ�ａｎｄＲａｄｉｘＰａｅｏｎｉａｅＡｌｂａｔｏＲａｄｉｘ
ＡｎｇｅｌｉｃａｅＳｉｎｅｎｓｉｓｓｈｏｗｅｄａｓｔｒｏｎｇｅｒｓｕｐｐｏｒｔｒａｔｉｎｇ；ＰｏｒｉａｔｏＲｈｉｚｏｍａＡｔｒａｃｔｙｌｏｄｉｓＡｌｂａ�ＲｈｉｚｏｍａＬｉｇｕｔｉｃｉｔｏ
ＲａｄｉｘＡｎｇｅｌｉｃａｅＳｉｎｅｎｓｉｓ�ＲａｄｉｘＡｎｇｅｌｉｃａｅＳｉｎｅｎｓｉｓｔｏＲｈｉｚｏｍａＬｉｇｕｔｉｃｉ�ＲｈｉｚｏｍａＡｔｒａｃｔｙｌｏｄｉｓＡｌｂａｔｏＰｏｒｉａ�
ａｎｄＲｈｉｚｏｍａＡｌｉｓｍａｔｉｓｔｏＰｏｒｉａｓｈｏｗｅｄａｓｔｒｏｎｇｓｕｐｐｏｒｔｒａｔｉｎｇ．Ｉｎｔｈｅａｓｐｅｃｔｏｆｃｏｎｔｒｉｂｕｔｉｏｎｒａｔｉｎｇｔｏｔｈｅ
ｗｈｏｌｅｆｏｒｍｕｌａ�ＲａｄｉｘＡｎｇｅｌｉｃａｅＳｉｎｅｎｓｉｓ＞Ｐｏｒｉａ＞ＲａｄｉｘＰａｅｏｎｉａｅＡｌｂａ＞ＲｈｉｚｏｍａＬｉｇｕｔｉｃｉ＞Ｒｈｉｚｏｍａ
ＡｔｒａｃｔｙｌｏｄｉｓＡｌｂａ＞ＲｈｉｚｏｍａＡｌｉｓｍａｔｉｓ．ＴｈｅｏｕｔｃｏｍｅｓｏｆｃｌｕｓｔｅｒｉｎｇａｎａｌｙｓｉｓｓｈｏｗｅｄｔｈａｔＲｈｉｚｏｍａＡｌｉｓｍａｔｉｓ
ｈａｄｔｈｅｓｔｒｏｎｇｅｓｔｒｅｌｅｖａｎｃｙｔｏｔｈｅｗｈｏｌｅｆｏｒｍｕｌａｏｆＤａｎｇｇｕｉｓｈａｏｙａｏＰｏｗｄｅｒ．Ｃｏｎｃｌｕｓｉｏｎ　
Ｉｎ
ＤａｎｇｇｕｉｓｈａｏｙａｏＰｏｗｄｅｒＲａｄｉｘＡｎｇｅｌｉｃａｅＳｉｎｅｎｓｉｓ�ＰｏｒｉａａｎｄＲａｄｉｘＰａｅｏｎｉａｅＡｌｂａａｒｅｔｈｅｍａｉｎｉｎｇｒｅｄｉｅｎｔｓ�
ＲｈｉｚｏｍａＡｌｉｓｍａｔｉｓｉｓｃｈａｒａｃｔｅｒｉｚｅｄｉｎｇｒｅｄｉｅｎｔ�ａｎｄＲｈｉｚｏｍａＬｉｇｕｔｉｃｉａｎｄＲｈｉｚｏｍａＡｔｒａｃｔｙｌｏｄｉｓＡｌｂａｐｌａｙ
ｉｍｐｏｒｔａｎｔｒｏｌｅｓ．
Ｋｅｙｗｏｒｄｓ：ＤａｎｇｇｕｉｓｈａｏｙａｏＰｏｗｄｅｒ；ｆｏｒｍｕｌａｆｏｒｍｉｎｇ；ｆｏｒｍｕｌａｉｎｇｒｅｄｉｅｎｔｓ；ａｓｓｏｃｉａｔｉｏｎｒｕｌｅｓ；ｄａｔａｍｉｎｉｎｇ
当归芍药散出自张仲景所著《金匮要略》�由当
归、芍药、川芎、茯苓、泽泻、白术组成�用于治疗“妇
人怀妊�腹中疞痛”及“妇人腹中诸疾痛”�被广泛用
于临床各科�治疗效果显著。组成当归芍药散的6
·299·
第32卷第5期2009年5月
Ｖｏｌ．32Ｎｏ．5Ｍａｙ．2009　
　
ＪｏｕｒｎａｌｏｆＢｅｉｊｉｎｇＵｎｉｖｅｒｓｉｔｙｏｆＴｒａｄｉｔｉｏｎａｌＣｈｉｎｅｓｅＭｅｄｉｃｉｎｅ
味药物�在浩瀚的中药和方剂的数据海洋中�可以以
各种组合形式存在�或单用�或合用�或独立成方�或
为其他方剂的组成部分。6味药物经仲景之手组成
了当归芍药散�这显然不是一个随机事件�而有其内
在规律和逻辑联系。数据挖掘是多学科技术的集
成
［1］。借助数据挖掘技术对当归芍药散组方原理
进行初步研究�将有利于深入了解该方的内涵�并为
进一步的实验研究提供基础。
1　
资料来源
药品资讯网（原新药研发咨询中心）建立的中
药方剂数据库（ｗｗｗ．ｃｈｅｍｄｒｕｇ．ｃｏｍ／Ｐｒｅｓｃｒｉｐｔｉｏｎ．
ａｓｐ）收录古今名方、验方、偏方等共计10704个。
2　
方法与结果
2．1　
数据库建立
利用中药方剂数据库�将当归芍药散组方药味
当归、芍药、川芎、白术、茯苓、泽泻分别输入进行检
索并统计。应用ＭｉｃｒｏｓｏｆｔＯｆｆｉｃｅＡｃｃｅｓｓ2003�建立
当归芍药散药味配伍数据库�字段名包括方名、来
源、药味名、药味配伍类型、主治等。
2．2　
数据统计与数据挖掘研究
对数据库中当归芍药散各药味之间相互配伍的
各种形式（2
6－1＝63种）出现的概率信息进行整
理�并用ＳＰＳＳ软件进行因子分析和聚类分析；同时
应用Ｃｌｅｍｅｎｔｉｎｅ数据挖掘系统�采用神经网络和广
义规则归纳法（ＧＩＲ算法）�计算当归、芍药、川芎、
茯苓、泽泻、白术之间的相互关联（支持度和置信
度）。
2．3　
数据整理
从数据库中共检出含有当归芍药散药味的方剂
7293个�除去重复方剂�共有有效数据3942条。
当归、芍药、白术、泽泻与其他药味配伍�芍药、川芎、
白术、泽泻和其他药味配伍�芍药、川芎、白术、茯苓、
泽泻和其他药味配伍�3种类型没有�故在全部63
种配伍类型中�实际配伍类型共计60种。将方剂库
中所有符合上述配伍类型的方剂检出并统计�考察
各种配伍类型出现的几率和药味组成情况。
2．4　
数据挖掘研究
2．4．1　
数据预处理：将数据格式化。如当归白术
汤�原方组成为：当归、白术、茯苓……�不含芍药、川
芎、泽泻�则按当归、芍药、川芎、白术、茯苓、泽泻的
顺序�将当归白术汤记为：｛1�0�0�1�1�0｝。同理�
将所有检索出的数据格式化�便于进一步挖掘。
2．4．2　
神经网络和ＧＩＲ算法计算当归芍药散药味
之间的相互关联结果：应用Ｃｌｅｍｅｎｔｉｎｅ神经网络算
法和ＧＩＲ计算6味药彼此的相互支持度。运算流程
如下（以当归为例）：①分析：估计的准确性�75．501；
输入层�5个神经元；隐藏层1�20个神经元；隐藏层
2�15个神经元；隐藏层3�10个神经元；输出层�1个
神经元。②字段：目标�当归；输入�芍药、川芎、白术、
茯苓、泽泻。③构建设置：方法�快速；样本（％）�
100．0；算法�神经网络、ＧＩＲ；模型类型�分类。④输入
的相对重要性：芍药�0．415937；川芎�0．353021；茯
苓�0．283897；白术�0．238492；泽泻�0．201752。同
上�我们分别求出6味药彼此的相互支持度�并以支
持度高低计分�估算出每味药对其他5味药的总支持
度�初步判断该味药对全方的贡献度。①相互支持
度：强支持（≥40％）�当归对芍药、芍药对当归；较强
支持（≥30％）�茯苓对白术、川芎对当归、当归对川
芎、白术对茯苓、泽泻对茯苓。②对全方的贡献度�当
归＞茯苓＞芍药＞川芎＞白术＞泽泻。
2．4．3　
因子分析和聚类分析：假设所有与当归芍药
散组成药味有关的方剂为1个集合｛当归芍药散｝。
文中集合共有3942个事务�并分别归属于60个各
自独立的子集｛当归｝、……、｛当归�芍药�川芎｝、
…、｛当归�芍药�川芎�白术�茯苓�泽泻｝。找出｛当
归芍药散｝的共性规律�进而研究由这些规律赋予
子集的属性（类别）。将｛当归芍药散｝中3942个
事务全面纳入运算�并通过ＳＰＳＳ进行因子分析、聚
类分析。①因子分析：采用主成分分析法、提取特征
值大于1的因子、进行方差最大正交旋转�将因子得
分作为新变量存入。共提取出6个因子�到第5个
因子可以解释88．861％的事务�为了全面反映所有
事务的特点�我们提取全部6个因子。引入上述6
个因子对数据进行校正�如补肝散原数据格式为：
｛1�0�1�1�0�0｝�校正后为：｛0．98825�－1．02474�
1．76546�1．74739�－0．77972�－0．17502｝。校正
后的数据从离散形式（0或1）�转换为连续数据�进
行聚类分析。②聚类分析：引入聚类分析的6个变
量（即上面的6个因子）�对所有事务进行聚类分
析�共聚为6类：第1类�主要解释当归、茯苓�部分
解释芍药�排除川芎、泽泻；第2类�主要解释白术�
部分解释芍药�排除川芎、泽泻；第3类�主要解释泽
泻�不排除其他药味；第4类�主要解释川芎�部分解
释芍药、当归�排除泽泻；第5类�主要解释泽泻�与
第3类的区别在于白术增加�当归、茯苓减少；第6
类�主要解释川芎�排除芍药、泽泻。结果见表1。
子集｛当归�芍药�川芎�白术�茯苓�泽泻｝�即当归
芍药散全方属于第3类。
·300·
　
　
　
　
　
　
　
　
　
　
　
　
　
　
　
　
第32卷
表1　
各类别方剂药味组成情况情况（个）
类别
当归
芍药
川芎
白术
茯苓
泽泻
1
1062
467
0
107
830
0
2
134
495
0
687
291
0
3
79
38
17
14
137
167
4
425
470
510
148
165
0
5
8
24
7
91
67
162
6
158
0
420
56
56
0
2．4．4　
建模：已知当归芍药散全方属于第3类�我
们重点讨论第3类的生成规则。应用ＳＰＳＳＣｌｅｍｅｎ-
ｔｉｎｅ�运用关联规则、决策树等算法�训练数据库�生
成规则（见图1）。从图1可看出进入第3类则必须
同时满足下列2个条件：①必须有泽泻；②当归和茯
苓同时存在�或当归和茯苓只有1个但没有白术。
上述条件是构成当归芍药散的必要条件�即满足上
述条件不一定就是当归芍药散�但不满足肯定不是
当归芍药散。
规则用于3-包含3个规则
规则1用于3
ｉｆ泽泻ｉｎ［1］
ａｎｄ当归ｉｎ［0］ａｎｄ茯苓ｉｎ［1］ａｎｄ白术ｉｎ［0］ｔｈｅｎ3
规则2用于3
ｉｆ泽泻ｉｎ［1］
ａｎｄ当归ｉｎ［1］ａｎｄ白术ｉｎ［0］ｔｈｅｎ3
规则3用于3
ｉｆ泽泻ｉｎ［1］
ａｎｄ当归ｉｎ［1］ａｎｄ白术ｉｎ［1］ａｎｄ茯苓ｉｎ［1］ｔｈｅｎ3
图1　
ＳＰＳＳＣｌｅｍｅｎｔｉｎｅ生成的指向第3类的规则
3　
讨论
从相互支持度结果可以发现�支持度高的当归
与芍药、茯苓与白术、当归和川芎等均是临床中药方
剂常用的药对或配伍形式�可见相互支持度结果是
可信的。6味药对全方的贡献度结果表明每味药对
全方的贡献度�这个结果与表1的顺序基本一致�即
药味出现的频率越高�其贡献度越高。从聚类分析
结果可以看出�要满足当归芍药散同时具备6个变
量的条件�则只有第3类和第5类。而第5类由于
白术增加�当归、茯苓减少�同时泽泻的权重达
45％�与当归芍药散原方发生背离�因此当归芍药散
属于第3类是可信的�同时泽泻对当归芍药散全方
关联最强。综上所述�在当归芍药散组成成分中�泽
泻为特征成分�当归、茯苓和芍药为主要成分�川芎
和白术在其中发挥重要作用。
6味药对全方的贡献度结果显示当归、茯苓、芍
药为本方主要组成�但这些药味也大量出现在其他
的方剂配伍中�这与这些药物是中医临床常用药物
的地位是相匹配的。甚至可以推论�在大多数的方
剂中�诸如人参、党参、黄芪、甘草、白术、当归、茯苓、
芍药等都是其主要组成�临证虽有药量加减�但药味
的有无却是质的差异。因此研究丰富多彩、各具特
色的方剂配伍�其药味组成的专属性或特有性应该
得到更多的重视。泽泻首载于《神农本草经》�列为
上品�性味甘、寒�归肾、膀胱经�功能利小便、清湿
热�用于小便不利、水肿胀满、泄泻尿少、痰饮眩晕、
热淋涩痛；高血脂症
［2］。《神农本草经》云“泽泻
……养五脏�益气力�久服耳目聪明�不饥�延年轻
身……”�但后世医家对此多有疑问�如《本草纲目》
云：“神农书列泽泻于上品�复云久服轻身……愚窃
疑之……。”对于泽泻�仲景认为：“水蓄渴烦�小便
不利�或吐或泻�……方用泽泻�故知其用长于行水
……。”统观《伤寒论》和《金匮要略》�含有泽泻的方
剂共7首：泽泻汤、五苓散、猪苓汤、茯苓泽泻汤、牡
蛎泽泻散、肾气丸和当归芍药散。前5方都是利水
行水之名方�肾气丸去附子桂枝即后世名方六味地
黄丸�唯独当归芍药散独属于《妇人病篇》下�且泽
泻用量宏大。其实在《金匮》原文中也可发现�说到
“妇人怀妊腹痛”在当归芍药散之前便有胶艾汤可
主之�说到“妇人疞痛”后见有当归生姜羊肉汤�说
到“妇人腹中诸疾痛”在当归芍药散后紧接“小建中
汤也可主之”。鉴于此�我们揣测仲圣立方原旨在
于�当归芍药散之证当为妇人血水之病且必见有水
病�泽泻一味不可少。数据挖掘结果也初步证明了
这一观点。
当然�研究结果还需要临床实践和实验研究来
检验�同时进一步的数据挖掘研究还必须将药量和
主治结合进来�并需要更多的样本数据�以便从更多
的维度和广度来研究中药复方这一复杂体系。
