·理论研究·
隐结构模型与中医辨证研究（ＩＩ）
∗
———肾虚数据分析
张连文
1　
袁世宏
2　
陈　
弢
1　
王　
燚
1
　
张连文�男�副教授
∗香港研究资助局项目（Ｎｏ．622015）�国家重点基础研究发展计划（973计划）项目（Ｎｏ．2003ＣＢ517101）
（1香港科技大学　
香港；2北京中医药大学）
关键词：隐结构模型；中医；辨证；肾虚
中图分类号：Ｒ241
　
　
我们提出一种为中医辨证建立客观定量标准
的研究方法�即隐结构法。在文献［1］中已经介
绍了隐结构法的基本步骤：首先对症状在人群中
的分布情况做流行病学调查�然后利用隐结构模
型对数据进行聚类分析�最后用得到的类指导辨
证、建立起辨证标准。为了探讨隐结构法的可行
性�我们用多层隐类（ＨＬＣ）模型对肾虚辨证进行
研究�收集和分析肾虚数据�并讨论所得隐变量及
隐类的中医学意义。
1　
数据收集及分析
在进行流行病学调查之前�需要确定调查所涉
及的症状。依据国家证候诊疗标准
［2］和中医诊断
学教材
［3］�我们选择了67个肾虚症状变量�包括精
神不振程度、腰部酸困程度、夜间尿频程度等。这些
变量反映了肾脏藏精主水纳气、主生殖、主骨生髓、
司二便、开窍于耳、其华在发、齿为骨之余等各方面
的生理功能和病理变化。变量的程度分为无、轻、
中、重4级。为保证可操作性、一致性�减少人为误
差�调查过程采用了严氏等
［4］所制定的肾虚症状轻
重程度判别标准。这个标准的建立考虑到了症状表
象轻重程度、伴随条件、持续时间、发作频率和诱发
条件5个因素。抽样调查的样本空间定为肾虚证常
常出现的60岁或以上人群。调查在成都、重庆、山
西、内蒙古等地的敬老院、老年大学、福利院、工厂、
农村进行�共收集数据2600例
［5］。
一个ＨＬＣ模型的质量可以用贝叶斯信息标准
评分（ＢＩＣ）
［6］来度量。ＢＩＣ评分一方面要求模型与
数据拟合、揭示数据中隐含的规律�另一方面要求模
型尽量简单。用ＨＬＣ模型分析数据就是要寻找
ＢＩＣ分数最高的最优ＨＬＣ模型
［7］。需要逐一考察
每一个可能的模型、计算其ＢＩＣ分、取分数最高者。
但因为所有可能的模型数量巨大�计算机无法一一
列举�于是需要搜索算法�故使用目前最好的启发式
单重爬山法（ＨＳＨＣ）
［8］分析肾虚数据。此算法暂时
无法处理数据所涉及的全部67个变量�故选择了其
中对肾虚辨证最重要的35个变量进行分析。分析
过程在1台2．4ＧＨｚ的奔腾ＩＶ计算机上耗时98．5
ｈ完成�得到的模型记为Ｍ0�它的ＢＩＣ分数为—739
47。爬山法有一个共同的缺点�就是有可能被困在
局部最优而找不到全局最优�为了帮助ＨＳＨＣ算法
跳出局部最优�我们利用背景知识对Ｍ0进行多方
面修改�得到一系列新模型�然后由此出发用ＨＳＨＣ
算法进一步自动搜索�最后取ＢＩＣ分最高的模型作
为分析结果。这个模型记为Ｍ
∗�它的ＢＩＣ分数是
—73860。数据分析过程中�人为因素的作用是�基
于ＨＳＨＣ算法所得的中间结果�为它的进一步搜索
提供出发点。整个搜索过程考察大量模型�取哪一
个作为最后结果是由ＢＩＣ评分来决定的。这意味着
对模型所作的人为修改如果违反ＢＩＣ原则就会被否
决�所以人为因素不影响数据分析结果的客观性。
模型Ｍ
∗的结构如图1所示�其中Ｙ0～Ｙ34是来
自数据的症状显变量�而Ｘ0～Ｘ13是在数据分析过
程中ＨＳＨＣ算法引入的隐变量。文献［1］中指出�
用隐结构模型分析数据就是对数据进行多维同时聚
类。通过对肾虚数据进行分析�得到包含14个隐变
量的模型Ｍ
∗�即找出了14个（相互关联的）隐聚类
指标�按这些指标被数据聚成了各式各样的类。这
些类称为隐类。例如�变量Ｘ2有3个取值�即按隐
指标Ｘ0把数据聚成了5个类；变量Ｘ1有5个取值�
即按隐指标Ｘ2同时又把数据聚成另外3个类等等。
·584·
ＪｏｕｒｎａｌｏｆＢｅｉｊｉｎｇＵｎｉｖｅｒｓｉｔｙｏｆＴｒａｄｉｔｉｏｎａｌＣｈｉｎｅｓｅＭｅｄｉｃｉｎｅ　
　
第31卷第9期2008年9月
Ｖｏｌ．31Ｎｏ．9Ｓｅｐ．2008
图1　
模型Ｍ
∗结构图
2　
隐变量诠释
模型Ｍ
∗结构图中的隐变量Ｘ1�它直接影响畏
寒怕冷、四肢冷、腰背冷这3个症状的出现和轻重程
度�同时又通过隐变量Ｘ2间接影响便稀、完谷不化
的出现和轻重程度。这与中医理论是否吻合？隐变
量Ｘ1和Ｘ2的意义是什么？中医理论认为�肾藏元
阳内寓命火�既可温煦脏腑经络、推动激发脏腑功能
活动�又能温肢体暖周身。当肾阳不足、失于温煦时
则可见畏寒肢冷、腰背怕冷。同时肾阳虚衰火不温
脾土�则可见完谷不化、大便溏薄。仔细分析对照模
型和中医理论中以上两段话�可以发现�它们讲的完
全是同一件事�即：有一个隐因子�它直接影响畏寒
怕冷、四肢冷、腰背冷这3个症状；同时它通过另一
隐因子间接影响便稀、完谷不化这2个症状。所以�
这个Ｍ
∗模型局部与中医理论基本吻合。中医理论
中与这2个隐因子对应的分别为肾阳虚失于温煦和
火不温脾土�即模型Ｍ
∗中的隐变量Ｘ1可诠释为肾
阳虚失温煦情况�Ｘ2可诠释为火不温脾土情况。
模型Ｍ
∗中的隐变量Ｘ3�它影响下肢浮肿、面目
浮肿的出现及其轻重情况。而中医理论认为�肾的
阳气亏虚�气化失司�水液失于蒸化则内停泛滥�溢
于上则面目浮肿�趋于下而见下肢浮肿。所以Ｍ
∗
模型这一局部与中医理论基本吻合�Ｘ3可诠释为肾
阳虚水泛情况。
在Ｘ4及其下这个局部�隐变量Ｘ4直接影响小
便余沥、夜尿频多、昼尿次多的出现和轻重程度�同
时又通过隐变量Ｘ5间接影响昼小便失禁和夜遗尿
的出现及轻重程度。中医理论认为膀胱为洲渎之
官�它的气化约束作用控制着小便开合排泄。当膀
胱气化失司�约束失职关门不利�则可见小便余沥不
尽、夜尿频多、昼尿次多。气化约束失职较重�关门
不能�则可使尿失禁锢而见夜遗尿、昼小便失禁。因
此就这一局部而言�模型Ｍ
∗与中医理论基本吻合�
其中Ｘ4可诠释为膀胱失约情况�而Ｘ5可诠释为尿
失禁锢情况。
中医认为肾精不足的临床表现有：耳鸣耳聋、健
忘恍惚、两足痿软、发脱齿摇、神情呆钝等�这些与
Ｘ8以下的症状变量基本一致�所以Ｘ8可诠释为肾
精亏虚情况。中医认为（肾）阴虚的临床表现有：失
眠、眩晕、口燥咽干、潮热颧红、五心烦热、盗汗、小便
短赤、舌红少津少苔、脉细数等�这些与Ｘ10以下的
症状变量基本一致�所以Ｘ10可诠释为（肾）阴虚情
况。中医认为久病可致肾虚�而肾虚的典型症状有
腰膝酸软、精神不振、脉弱�其子证型包括肾阳虚、肾
阳虚水泛、肾阴虚、肾精亏虚、膀胱失约等�这些与
Ｘ0周围的情况基本一致�所以Ｘ0可诠释为肾虚
情况。
数据分析所涉及的35个症状变量全部与肾虚
有关�因此在模型Ｍ
∗中有一个隐变量与肾虚对应
是意料之中的。然而模型Ｍ
∗中有隐变量与肾阳虚
失温煦、肾阳虚水泛、膀胱失约、肾精亏虚、（肾）阴
虚等证候因子对应这件事却十分有意义。首先�根
据中医理论肾阳虚失温煦等证候因子只与部分症状
变量直接相关�而不是与全部症状变量直接相关�并
·585·
第9期
张连文等　
隐结构模型与中医辨证研究（ＩＩ）———肾虚数据分析
且不同证候因子影响不同症状变量。其次�模型
Ｍ
∗中的隐变量是按照统计学原则从数据里面提取
出来的�具有客观性。因此�我们的数据分析显示了
肾阳虚失温煦等证候因子的客观性。
模型Ｍ
∗与中医理论也有不一致的地方。首
先�肾虚的其他子证候如肾气不固、肾不纳气等没有
在Ｍ
∗中反映出来。肾气不固没有在Ｍ
∗中反映出
来是因为没有收集到生殖、性生活方面的有关数据；
而肾不纳气没有在Ｍ
∗中反映出来是由于除了咳嗽
喘息以外�肾不纳气的其他症状�如呼吸表浅、呼多
吸少、咳嗽无力等�被排除在分析范围以外。另外�
在中医理论中�阴虚和精亏都可以导致失眠和头晕�
然而在模型Ｍ
∗中失眠和头晕却只与Ｘ10（阴虚）相
连。这样的差异源自ＨＬＣ模型的一个限制：ＨＬＣ模
型要求隐、显变量之间的关系成树状结构
［7］�从而
一个显变量只能与一个隐变量相连。放松这个限制
是隐结构模型研究下一步要解决的主要问题之一。
中医理论有不完整和模糊的地方�不能完全转
化为数学或逻辑命题�因此任何一个数学模型都不
可能与之百分之百吻合。中医理论是从几千年不断
临床实践中提炼出来的�我们的目标就是要通过现
代数据分析�重复这个提炼过程�使中医理论得到发
展。上述结果表明�这个目标是可以实现的。
3　
隐类诠释
模型Ｍ
∗中隐变量Ｘ1被诠释为肾阳虚失于温
煦情况�它有5个可能的取值�即按照肾阳虚失于温
煦情况这个隐指标把数据聚成了5个隐类；隐变量
Ｘ4被诠释为膀胱失约情况�有4个可能的取值�即
按照膀胱失约情况�把数据聚成了另外4个隐类等。
下面以Ｘ4给出的4个隐类为例�讨论这些隐类的中
医学意义。
在模型Ｍ
∗中位于Ｘ4下面的症状变量有小便
余沥（Ｙ7）、夜尿频（Ｙ8）、昼小便失禁（Ｙ9）、夜遗尿
（Ｙ10）和昼尿次多（Ｙ11）。图2展示这些显变量在
Ｘ4给出的4个隐类中的概率分布：共有4幅直方
图�对应4个隐类；每幅直方图中有5个柱体�对应
Ｙ7等5个症状变量；一个柱体最多由4段组成�每
一段对应症状变量的一个取值：黑色段的长度代表
症状变量取值为“重”的概率�白色段（位于顶端）的
长度代表症状变量取值为“无”的概率�而2个灰色
段的长度分别代表症状变量取值为“轻”和“中”的
概率。概率直方图展示了隐类的整体性质。另一方
面�典型成员表（见表1）给出各隐类中最典型成员
的情况�让我们对隐类的成员有一个具体认识。类
Ｘ4＝ｓ
3的典型成员是‘Ｙ7＝3、Ｙ8＝3、Ｙ9＝3、Ｙ10＝
3、Ｙ11＝3’�这是因为是它属于类Ｘ4＝ｓ
3的概率
Ｐ（Ｘ4＝ｓ
3Ｙ7＝3、Ｙ8＝3、Ｙ9＝3、Ｙ10＝3、Ｙ11＝3）在
所有可能成员中是最高的。
表1　
隐变量Ｘ4各隐类典型成员比较
隐类
Ｙ7
Ｙ8
Ｙ9
Ｙ10
Ｙ11
ｓ
0
0
0
0
0
0
ｓ
1
1
1
0
0
1
ｓ
2
0
3
0
0
0
ｓ
3
3
3
3
3
3
通过考察图2可以把握Ｘ4给出的4个隐类的
含义。首先�隐变量Ｘ4的意义是膀胱失约情况�因
此它所给出的4个类可视为膀胱失约的4种不同状
态。在类Ｘ4＝ｓ
0中�小便余沥等5个症状出现的概
率很低�其典型成员完全没有这些症状�所以它可以
诠释为无膀胱失约。其次�在类Ｘ4＝ｓ
3中�小便余
沥等5个症状出现的概率很高�它的典型成员5个
症状都有�而且是重度�所以它可以诠释为重度膀胱
失约。接下来考虑Ｘ4＝ｓ
1和Ｘ4＝ｓ
2这2个类。在
这2个类中小便余沥等5个症状出现的概率介乎于
类Ｘ4＝ｓ
0和Ｘ4＝ｓ
3之间。而就它们两者之间比较
而言�各症状在Ｘ4＝ｓ
1中出现的总概率虽然高于在
图2　
各症状变量在隐变量Ｘ4各隐类中的概率比较
·586·
　
　
　
　
　
　
　
　
　
　
　
　
　
　
　
　
第31卷
表2　
隐变量中医证候意义诠释分析列表
隐变量
隐变量诠释
ｓ
0隐类
ｓ
1隐类
ｓ
2隐类
ｓ
3隐类
ｓ
4隐类
Ｘ1
肾阳虚失温煦情况
无
轻1
轻2
中
重
Ｘ3
肾阳虚水泛情况
无
轻1
轻2
重
—
Ｘ4
膀胱失约情况
无
轻1
轻2
重
—
Ｘ8
肾精亏虚情况
无
轻1
轻2
重
—
Ｘ10
（肾）阴虚情况
无
轻
中1
中2
重
Ｘ4＝ｓ
2中出现的总概率�但各症状在Ｘ4＝ｓ
1中以中
度或重度出现的概率却低于在Ｘ4＝ｓ
2中以中度或
重度出现的概率。类Ｘ4＝ｓ
1的典型成员有3个轻
度症状�即轻度小便余沥、轻度夜尿频、和轻度昼尿
次多；而类Ｘ4＝ｓ
2的典型成员有1个重度症状�即
重度夜尿频。综合这些情况来看�类Ｘ4＝ｓ
1和Ｘ4
＝ｓ
2都有轻度膀胱失约的意义。据此�我们把他们
分别诠释成轻度膀胱失约（1）和轻度膀胱失约（2）。
除Ｘ4以外�我们还对Ｘ1、Ｘ3、Ｘ8和Ｘ10所给出
的隐类的意义进行了分析
［5］�发现它们可按表2诠
释。之所以只考虑上述5个隐变量�是因为它们反
映了肾虚证几个主要方面。
中医理论中有一些关于症状出现频率的定性论
断。比方说�中医认为若肾气亏虚�膀胱气化失司�
失去约束固摄功能�轻则夜尿频多、小便余沥不尽�
重则昼小便失禁、夜遗尿。换句话说�小便失禁和夜
遗尿出现的频率低于小便余沥等其他3个症状出现
的频率。这与图2不谋而合。只有在Ｘ4＝ｓ
3（重）
时�小便失禁（Ｙ9）和夜遗尿（Ｙ10）才有较大概率会
出现；即使此时�它们以重度出现的概率还是很小。
另外�中医认为夜尿频多（Ｙ8）是肾虚的典型症状�
这与它在Ｘ4＝ｓ
1、Ｘ4＝ｓ
2和Ｘ4＝ｓ
3这3个类中出现
的概率都很大的事实相吻合。
中医理论中关于症状出现频率的定性论断有很
多�其中与模型Ｍ
∗相关的都与Ｍ
∗吻合
［5］。我们的
数据分析为这些论断的正确性提供了客观的统计学
支持�并进一步把它们进行了定量化。
4　
隐结构法与辨证论治
清代医家叶天士在《临证指南医案》中说：“医
道在乎识证、立法、用方�此为三大关键�一有草率�
不堪为医也。……然三者之中�识证尤为紧要。”隐
结构法通过对数据进行多维聚类分析�能够深化我
们对证候的认识�帮助我们更好地识证、立方�从而
提高辨证论治水平。
用隐结构模型分析数据可以找出隐变量�并且
以它们为指标把数据聚为多个隐类。研究结果表
明�使用隐结构法能够获得有明显证候意义的隐类�
而对这些隐类的研究能对中医证候学的发展起推动
作用。具体地说�我们可以：①对每个证候隐类进行
研究�根据其症状的统计特性找到针对它们的治疗
方案（基本证候论治研究）；②在临床辨证论治时�
计算出病人属于各隐类的后验概率（识证）；③基于
这些概率将基本证候的治疗方案进行适当组合�得
到对病人的治疗方案（立法、用方）。这样�辨证论
治的客观性、定量性、规范性都可以得到提高。其中
模型辨证内容�我们会在后文继续讨论�其他是需要
将来进一步研究的课题。
