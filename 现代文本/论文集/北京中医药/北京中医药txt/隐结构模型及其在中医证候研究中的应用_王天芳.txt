·理论研究·
隐结构模型及其在中医证候研究中的应用
∗
王天芳
1　
张连文
2　
赵　
燕
1　
王　
燚
2　
吴秀艳
1　
袁世宏
1　
王智瑜
1
杜彩凤
1　
徐雯洁
3　
于春光
1　
陈　
弢
2　
潘建文
2　
王庆国
1
　
王天芳�女�博士�教授�博士生导师�Ｅ-ｍａｉｌ：ｗａｎｇｔｆ＠ｂｕｃｍ．ｅｄｕ．ｃｎ
∗国家重点基础研究发展计划（973计划）资助项目（Ｎｏ．2003ＣＢ517106�Ｎｏ．2003ＣＢ517101）�香港研究资助局项目（Ｎｏ．622307�
Ｎｏ．622408）
（1北京中医药大学基础医学院　
北京100029；2香港科技大学；3北京市中医院）
摘要：用隐结构法研究中医证候的基本思想是运用隐结构模型对临床流行病学调查获取的、未经过
医生事先辨证的症状数据进行多维聚类分析�为证候的规范化、标准化研究提供较为客观的依据。
在系统阐述隐结构分析及隐结构模型诠释的原理和工具的基础上�提出了隐结构法应用于中医证
候研究的意义及步骤�并以抑郁症的隐结构模型为例�示范了隐变量和隐类诠释的方法和步骤�以
期为今后从病证结合角度进行类似的研究提供参考。
关键词：隐结构模型；证候；抑郁症
中图分类号：Ｒ241
ＬａｔｅｎｔｓｔｒｕｃｔｕｒｅｍｏｄｅｌｓａｎｄｔｈｅｉｒａｐｐｌｉｃａｔｉｏｎｉｎＴＣＭｓｙｎｄｒｏｍｅｒｅｓｅａｒｃｈ
∗
ＷＡＮＧＴｉａｎ-ｆａｎｇ
1�ＺＨＡＮＧＮｅｖｉｎ-ｌｉａｎｗｅｎ
2�ＺＨＡＯＹａｎ
1�ＷＡＮＧＹｉ
2�ＷＵＸｉｕ-ｙａｎ
1�ＹＵＡＮＳｈｉ-ｈｏｎｇ
1�
ＷＡＮＧＺｈｉ-ｙｕ
1�ＤＵＣａｉ-ｆｅｎｇ
1�ＸＵＷｅｎ-ｊｉｅ
3�ＹＵＣｈｕｎ-ｇｕａｎｇ
1�ＣＨＥＮＴａｏ
2�ＰＯＯＮＫｉｎｍａｎ
2�
ＷＡＮＧＱｉｎｇ-ｇｕｏ
1
（1ＳｃｈｏｏｌｏｆＰｒｅｃｌｉｎｉｃａｌＭｅｄｉｃｉｎｅ�ＢｅｉｊｉｎｇＵｎｉｖｅｒｓｉｔｙｏｆＣｈｉｎｅｓｅＭｅｄｉｃｉｎｅ�Ｂｅｉｊｉｎｇ　
100029；2Ｈｏｎｇ
ＫｏｎｇＵｎｉｖｅｒｓｉｔｙｏｆＳｃｉｅｎｃｅａｎｄＴｅｃｈｎｏｌｏｇｙ；3ＢｅｉｊｉｎｇＨｏｓｐｉｔａｌｏｆＣｈｉｎｅｓｅＭｅｄｉｃｉｎｅ）
Ａｂｓｔｒａｃｔ：ＴｈｅｂａｓｉｃｉｄｅａｔｏａｐｐｌｙｌａｔｅｎｔｓｔｒｕｃｔｕｒｅｍｏｄｅｌｓｉｎＴＣＭｓｙｎｄｒｏｍｅｒｅｓｅａｒｃｈｉｓｔｏｆｉｒｓｔｃｏｌｌｅｃｔｄａｔａ
ｏｎｔｈｅｏｃｃｕｒｒｅｎｃｅｏｆｓｙｍｐｔｏｍｓ（ｂｕｔｗｉｔｈｏｕｔＴＣＭｓｙｎｄｒｏｍｅｄｉａｇｎｏｓｉｓ）ｔｈｒｏｕｇｈｅｐｉｄｅｍｉｏｌｏｇｉｃａｌｓｕｒｖｅｙ�ａｎｄ
ｔｈｅｎｐｅｒｆｏｒｍｍｕｌｔｉｄｉｍｅｎｓｉｏｎａｌｃｌｕｓｔｅｒｉｎｇａｎａｌｙｓｉｓｏｎｔｈｅｄａｔａｕｓｉｎｇｌａｔｅｎｔｓｔｒｕｃｔｕｒｅｍｏｄｅｌｓ．Ｔｈｅｏｂｊｅｃｔｉｖｅｉｓ
ｔｏｐｒｏｖｉｄｅａｎｏｂｊｅｃｔｉｖｅａｎｄｑｕａｎｔｉｔａｔｉｖｅｂａｓｉｓｆｏｒｔｈｅｓｔａｎｄａｒｄｉｚａｔｉｏｎｏｆＴＣＭｓｙｎｄｒｏｍｅｄｉｆｆｅｒｅｎｔｉａｔｉｏｎ．Ｉｎ
ｔｈｉｓｐａｐｅｒ�ｗｅｓｙｓｔｅｍａｔｉｃａｌｌｙｅｘｐｌａｉｎｔｈｅｃｏｎｃｅｐｔｕａｌａｄｖａｎｃｅｓｏｎｔｈｅｕｎｄｅｒｌｙｉｎｇｐｒｉｎｃｉｐｌｅｓａｎｄｐｏｔｅｎｔｉａｌｓｏｆ
ｔｈｅａｐｐｒｏａｃｈ�ａｎｄｔｈｅｔｅｃｈｎｉｃａｌａｄｖａｎｃｅｓｏｎｔｈｅｉｎｔｅｒｐｒｅｔａｔｉｏｎｏｆｌａｔｅｎｔｓｔｒｕｃｔｕｒｅｍｏｄｅｌｓ．Ｔｈｅｅｘｐｏｓｉｔｉｏｎｉｓ
ｉｎｔｅｒｍｓｏｆａｓｔｕｄｙｏｎｄｅｐｒｅｓｓｉｏｎｓｏａｓｔｏｐｒｏｖｉｄｅａｎｅｘａｍｐｌｅｏｆｒｅｆｅｒｅｎｃｅｆｏｒｆｕｔｕｒｅｒｅｓｅａｒｃｈ．
Ｋｅｙｗｏｒｄｓ：ｌａｔｅｎｔｓｔｒｕｃｔｕｒｅｍｏｄｅｌｓ；ｓｙｎｄｒｏｍｅ；ｄｅｐｒｅｓｓｉｏｎ
　
　
证（又称证候）是疾病过程中某一阶段（时点）
机体对内外致病因素做出的综合反映�在宏观上表
现为一组特定症状（包括自觉症状和体征）�反映了
疾病的病因、病位、病性以及邪正相争的状况和趋
势�是临床论治的前提和依据。临床中对于证候的
辨识和判断�主要是依据医者对于病人症状表现的
理解与分析�带有很强的主观性�因此具体到某一证
候到底应有哪些表现�以及具备哪些表现可以被判
断为某一证候�也就是被大家认可的证候的规范和
诊断标准的建立�一直是中医研究中的一个难点和
关键的问题。
症状是病人患病后所表现出来的异常表现�是
医生通过望、闻、问、切四诊所获取的疾病信息�它们
是可以被直接观察到的�因此称为显变量。而病人
所患疾病的具体病理机制及所属证候�则需要医者
对病人的症状表现进行一系列分析而得出（该过程
·519·
第32卷第8期2009年8月
Ｖｏｌ．32Ｎｏ．8Ａｕｇ．2009　
　
ＪｏｕｒｎａｌｏｆＢｅｉｊｉｎｇＵｎｉｖｅｒｓｉｔｙｏｆＴｒａｄｉｔｉｏｎａｌＣｈｉｎｅｓｅＭｅｄｉｃｉｎｅ
称为辨证）�相对而言不是直接被观察到的�而是通
过症状（显变量）来间接把握的�因此称为隐变量。
抽象地说�中医辨证学所描述的是隐变量（证候、病
机等）与显变量（症状）�以及隐变量与隐变量之间
的关系�在这种意义下�可以将中医的辨证学理解为
是一个用自然语言描述的隐结构模型�以下称之为
中医隐结构模型。
一般来说�一个变量代表一种对事物的划分。如
性别这个变量代表将地球上的人划分为男人和女人
两个类。中医中的隐变量代表的是从医学角度对人
群进行划分。以肾阳虚为例�如果谈论有无肾阳虚�
在概念上则是将人群划分为有肾阳虚和无肾阳虚两
个类。如果在有肾阳虚的情况下�进一步谈论其轻、
中、重�在概念上就是将人群划分为无肾阳虚、有轻度
肾阳虚、有中度肾阳虚和有重度肾阳虚四个类。中医
中有众多隐变量�每个隐变量都代表一种划分。在这
种意义下�可以将中医辨证学理解为是基于症状、从
各种角度对人群进行了多维划分。因此�隐结构和多
维划分是中医辨证学两个不可分割的特征。
中医辨证所面临的关键问题是其划分边界缺乏
客观的、定量的依据�难以建立统一的辨证标准。隐
结构法
［1－5］的目标就是要解决这个问题。其基本
思想是运用隐结构模型对大样本的临床流行病学调
查获取的、未经过医生事先辨证的症状数据�按照统
计学原则进行分析�获得统计学隐结构模型。该模
型是基于数据本身的特征、从各种角度对人群进行
多维划分的结果�其反映的是蕴含在数据中的规律�
而不是某一个或几个医者的主观认识�具有较强的
客观性和定量性�因此可以作为建立中医辨证规范
和标准的一个重要依据。
1　
隐结构分析的工具
目前�隐结构法使用的数据分析工具是隐树模
型（ｌａｔｅｎｔｔｒｅｅｍｏｄｅｌ）。隐树模型是一种树状贝叶斯
网
［6］�以前称为多层隐类模型（ｈｉｅｒａｒｃｈｉｃａｌｌａｔｅｎｔ
ｃｌａｓｓｍｏｄｅｌ）
［7］。图1给出了一个隐树模型的例子�
其中叶节点代表显变量�其他节点代表隐变量。例
子中�高考学生的数学成绩、理综成绩、语文成绩和
文综成绩是显变量�而智力、分析能力和语言能力则
是隐变量。从分析能力到数学成绩有一个箭头�表
示数学成绩直接依赖分析能力�具体依赖情况通过
表1中的条件概率而定量刻画。表1中第1行是
说�分析能力低的学生在数学科有0．5的概率不及
格�0．4的概率及格�0．1的概率得良�而得优的概率
则是0�其他2行的含义类推。模型中的其他箭头
代表其他变量之间直接依赖关系�每个箭头都有相
应的条件概率分布。
图1　
隐树模型示意图
表1　
条件概率分布［Ｐ（数学成绩｜分析能力）］
分析能力
数学成绩
不及格
及格
良
优
低
0．5
0．4
0．1
0
中
0．1
0．4
0．4
0．1
高
0
0．1
0．4
0．5
只包含一个隐变量的隐树模型称为隐类模型
（ｌａｔｅｎｔｃｌａｓｓｍｏｄｅｌ）。隐类模型用于对数据进行聚
类分析�也就是单维划分。在以往西医的有关研究
中�曾有学者用其建立诸如类风湿关节炎、抑郁症、
慢性疲劳综合征等病症的诊断标准
［8－9］。
隐结构法的第一步�是用隐树模型对无监督数
据进行分析�目前这一步使用的算法是扩调减算法
（ＥｘｐａｎｓｉｏｎＡｄｊｕｓｔｍｅｎｔＳｉｍｐｌｉｆｉｃａｔｉｏｎｕｎｔｉｌＴｅｒｍｉｎａ-
ｔｉｏｎ�ＥＡＳＴ）。ＥＡＳＴ在一个称为贝叶斯信息准则
（Ｂａｙｅｓｉｎｆｏｒｍａｔｉｏｎｃｒｉｔｅｒｉｏｎ�ＢＩＣ）
［10］的统计学原则
指导下�在隐树模型空间中进行搜索。ＢＩＣ准则要
求模型与数据尽量紧密地拟合�但其复杂度又不能
过高。在搜索过程中�模型与数据的拟合程度不断
改进�从而ＢＩＣ分逐步增加。当模型变得太复杂时�
ＢＩＣ不升反降�这时搜索过程停止。
相对于隐类模型来说�隐树模型已经做了很大
推广�但是树结构仍然有其局限性�它有时会使得模
型不能很好地拟合数据。为了让模型与数据的拟合
程度尽量的高�在隐树分析结束后�需要对所得的
隐树模型进行加边（即加箭头）。目前使用的加边
算法叫ＬＴＭ-ＥＡ�它是在ＢＩＣ准则指导下的另一个
搜索过程�每一步加一条边。在高考学生成绩的例
子中�对图1所示的模型进行加边�可能会得到图2
所示的模型。这个模型不再是树状的�是一个比隐
·520·
　
　
　
　
　
　
　
　
　
　
　
　
　
　
　
　
第32卷
树模型更复杂的贝叶斯网。
图2　
隐树模型加边示意图
2　
隐结构模型诠释的原理和工具
隐结构分析的结果是一个隐结构模型�其中一
般包含多个隐变量。隐结构模型中的每个隐变量代
表一个对数据样本的划分�隐变量的每个取值对应
划分中的一个类�称为隐类。隐结构模型诠释就是
要基于应用领域知识�把握这些划分以及各个隐类
的含义。
2．1　
把握划分的含义
把握一个划分的含义�就是要看看划分使用的
主要标准是什么？为此�需要分析其中各个类之间
的区别主要在哪些方面。作为例子�假设有智力游
戏机给出如图3所示的、关于几何图形的三个划分�
并且问：每个划分所使用的标准是什么？第一个划
分（Ｗ1）由两个类组成�直观上它们的区别主要在图
形的形状�上面的类中全部是正方形�下面的类全部
是三角形�所以Ｗ1是一个基于图形形状的划分。第
二个划分（Ｗ2）也是由两个类组成的�直观上它们的
区别主要在图形的大小�左边类中的图形大�右边类
中的图形小�所以Ｗ2是一个基于图形大小的划分。
第三个划分（Ｗ3）由四个类组成�它们在图形的形状
和大小两方面都有区别�直观上Ｗ3是一个基于图
形形状和大小这两个因素的划分。
Ｗ1为基于图形形状的划分　
Ｗ2为基于图形大小的划分　
Ｗ3为基于图形形状和大小的划分
图3　
几何图形的划分示意图
在图3中对Ｗ1划分的诠释应注意的第一个基
本问题是：划分Ｗ1中的两个类�除了在图形形状方
面有区别以外�在线条粗细方面也有区别�上面类中
的线条多数较粗�而下面类中的线条多数较细。那
么�为什么在图形形状方面的区别是主要的�而在
线条粗细方面的区别是次要的呢？一般地讲�在一
个划分中�不同类之间在多个方面可能都有区别�哪
些方面的区别是主要的�哪些方面的区别是次要的？
怎样判断？这个问题可以利用互信息来回答。设Ｙ
是一个隐变量�Ｘ是一个显变量�Ｙ和Ｘ的互信息Ｉ
（Ｙ；Ｘ）度量的是这两个变量之间关系的紧密程
度
［11］。从另外一个角度看�变量Ｙ代表一个划分�
划分中的各个类之间有区别�而且区别是多方面的�
Ｉ（Ｙ；Ｘ）可以用来度量各个类在变量Ｘ这方面的区
别�互信息越高�在Ｘ这方面的区别就越大。如果
在所有显变量中�Ｘ与Ｙ的互信息最大�那么�Ｙ划
分中各个类在Ｘ这方面的区别就是主要的�而在其
他方面的区别就是次要的。
在上述几何图形划分的例子中�把变量分别简
记为图形形状（ＸＺ）、图形大小（ＤＸ）和线条粗细
（ＣＸ）。通过计算可以得到：Ｉ（Ｗ1；ＸＺ）＝0．69�Ｉ
（Ｗ1；ＤＸ）＝0�Ｉ（Ｗ1；ＣＸ）＝0．16。这表明�Ｗ1与
ＸＺ的互信息大于它与ＣＸ的互信息。所以划分Ｗ1
中的两个类在“图形形状”方面的区别确实是主要
的�而在“线条粗细”方面的区别确实是次要的。
在图3中对Ｗ1划分的诠释应注意的第二个基
本问题是：虽然划分Ｗ1中的两个类在“图形形状”
方面的区别相对为大�但是它们在“线条粗细”方面
也有明显区别。那么�在诠释Ｗ1时�除了考虑“图
形形状”�是否需要同时考虑“线条粗细”呢？为了
回答这个问题�计算Ｗ1与ＸＺ和ＣＸ这两个变量间
的互信息�结果是：Ｉ（Ｗ1；ＸＺ�ＣＸ）＝0．69�这与Ｉ
（Ｗ1；ＸＺ）相同。这就是说�划分Ｗ1中的两个类在
ＸＺ这一个方面的区别与它们在ＸＺ和ＣＸ这两个方
·521·
第8期
王天芳等　
隐结构模型及其在中医证候研究中的应用
面的区别是等量的�所以只需要考虑在ＸＺ这方面
的区别。实际上�Ｗ1与ＸＺ、ＣＸ和ＤＸ这三个变量间
的互信息Ｉ（Ｗ1；ＸＺ�ＣＸ�ＤＸ）也是0．69。这表明“图
形形状”这一个因素已经反映出了划分Ｗ1中两个
类的所有区别�因此在诠释Ｗ1时�只需考虑“图形
形状”�而不需要同时考虑其他因素。于是�可以
将Ｗ1诠释基于“图形形状”这个因素的划分。同
样�在诠释划分Ｗ2时�由于Ｉ（Ｗ2；ＤＸ）＝0．53＝Ｉ
（Ｗ2；ＤＸ�ＣＸ�ＸＺ）�只需要考虑“图形大小”这个因
素。于是�可以将Ｗ2诠释基于“图形大小”这个因
素的划分。
在诠释划分Ｗ3时�由于Ｉ（Ｗ3；ＸＺ）＝0．69＜
1．21＝Ｉ（Ｗ3；ＤＸ�ＣＸ�ＸＺ）和Ｉ（Ｗ3；ＤＸ）＝0．53＜
1．21＝Ｉ（Ｗ3；ＤＸ�ＣＸ�ＸＺ）�只考虑“图形形状”或者
只考虑“图形大小”是不够的�需要同时考虑多个因
素。由于Ｉ（Ｗ3；ＸＺ�ＤＸ）＝1．21＝Ｉ（Ｗ3；ＤＸ�ＣＸ�
ＸＺ）�同时考虑“图形形状”和“图形大小”这两个因
素就足够了。于是�可以将Ｗ3诠释基于“图形形
状”和“图形大小”这两个因素的划分。
2．2　
信息曲线与信息覆盖度
在对一个隐变量Ｙ所代表的划分进行诠释时�
需要找出与Ｙ关系最密切的显变量�从而确定划分
中的各个类在哪些方面的区别是主要的。为了方便
找到与Ｙ密切相关的显变量�引入两两互信息曲线
的概念。计算Ｙ与每一个显变量的互信息�并且按
照其大小把显变量排序为Ｘ1�Ｘ2�．．．�Ｘｎ�其中Ｙ与
Ｘ1的互信息最大�与Ｘ2的互信息次之�等等。将Ｙ
与各个显变量的互信息Ｉ（Ｙ；Ｘ1）�Ｉ（Ｙ；Ｘ2）�…�Ｉ
（Ｙ；Ｘｎ）依次描记在一个坐标里�并用一条线把它们
连接起来�就得到Ｙ的两两互信息曲线。图4给出
了划分Ｗ1、Ｗ2和Ｗ3的两两互信息曲线。
图4　
划分Ｗ1、Ｗ2和Ｗ3的两两互信息曲线和累计互信息曲线
在对一个隐变量Ｙ所代表的划分进行诠释时�
需要考虑显变量是否反映出隐类之间的全部区别�
从而决定诠释需要几个显变量。因此�引入累计互
信息和信息覆盖度的概念。对在1和ｎ之间的任何
一个整数ｉ�计算Ｙ与前ｉ个显变量的互信息Ｉ（Ｙ；
Ｘ1�Ｘ2�．．．�Ｘｉ）�并把它们也描记在坐标里�用线连
起来�就得到Ｙ的累计互信息曲线。划分Ｗ1�Ｗ2
和Ｗ3的累计互信息曲线见图4。另外�Ｉ（Ｙ；Ｘ1�
Ｘ2�．．．Ｘｉ）与Ｉ（Ｙ；Ｘ1�Ｘ2�．．．Ｘｎ）的比�即
Ｉ（Ｙ；Ｘ1�Ｘ2�．．．Ｘｉ）
Ｉ（Ｙ；Ｘ1�Ｘ2�．．．Ｘｎ）�称为前ｉ个显变量对Ｙ的信息
覆盖度。为了理解这个概念�考虑Ｙ划分中各个隐
类之间的区别�Ｉ（Ｙ；Ｘ1�Ｘ2�．．．�Ｘｉ）度量的是前ｉ
个显变量反映出来的区别�而Ｉ（Ｙ；Ｘ1�Ｘ2�．．．�Ｘｎ）
度量的是所有显变量反映出来的总区别�两者之比
就是前ｉ个显变量所反映出来的区别占总量的百分
比�因此称为信息覆盖度。如果信息覆盖度是1或
接近1�那么前ｉ个显变量就反映出了各个隐类之
间全部或者几乎全部的区别�从而可以基于它们进
行诠释。
作为使用信息曲线和信息覆盖度的例子�察看
图4中的3幅图。左边的图清楚显示�与Ｗ1关系
最密切的变量是“图形形状”�而且它对Ｗ1的信息
覆盖度已达到100％�所以可以将Ｗ1视为基于“图
形形状”的划分。同样�中间的图明确显示�Ｗ2可
以视为基于“图形大小”的划分。右边的图显示�与
Ｗ3关系最密切的变量是“图形形状”。但是�由于
这个变量对Ｗ3信息覆盖度只有53％�不能够把Ｗ3
视为仅仅基于“图形形状”这一个因素的划分�还需
要考虑其他因素。根据信息曲线�与Ｗ3关系第二
密切的变量是“图形大小”。它和“图形形状”加在
一起�对Ｗ3的信息覆盖度达到100％�所以可以将
Ｗ3视为基于“图形形状”和“图形大小”两个因素的
划分。
3　
隐结构法应用于中医证候研究的步骤
下面通过抑郁症的研究实例�介绍将隐结构法
·522·
　
　
　
　
　
　
　
　
　
　
　
　
　
　
　
　
第32卷
应用于中医证候研究的基本思想是：通过对基于临
床调查的抑郁症的症状数据进行多维聚类分析�建
立隐结构模型�结合中医专业知识对模型的内容进
行分析�希望发现其中的一些隐类具有中医辨证意
义�从而说明可根据辨证对抑郁症患者进行分类；
为提取抑郁症的常见中医证候（和／或证候要素）及
建立抑郁症的中医辨证规范（标准）提供较为客观
的、量化的依据。其具体步骤包括以下5个方面：
①进行较大样本的临床流行病学横断面调查�收集
抑郁症患者的中医症状数据；②数据库的建立及对
收集的数据进行预处理；③对数据进行隐结构分析；
④对获得的隐结构模型进行诠释；⑤探索研究结果
的意义和用途。
3．1　
临床流行病学调查
从病证结合研究入手�在系统回顾近10年有关
抑郁症证候研究的相关文献的基础上�结合临床经
验�借鉴现代心理学量表的研究方法�编制了抑郁症
中医四诊信息采集表�通过全国多中心的临床流行
病学横断面调查�对符合抑郁症纳入标准的604例
患者的症状信息进行了采集。
3．2　
数据库的建立及数据预处理
应用Ｅｐｉｄａｔａ3．0软件建立数据库�由2人分别
独立进行数据录入。由于隐结构分析复杂度高�受
计算机运算能力的限制�分析数据时只选择了出现
频率较高的100个显变量；又因为样本量相对较小�
将调查症状由多值变量转为二值变量（0或1）。
3．3　
数据的隐结构分析
预处理之后的数据先用ＥＡＳＴ算法分析�得到一
个含34个隐变量的隐树模型�其ＢＩＣ分是－26807。
接着用ＬＴＭ-ＥＡ算法进行加边�ＢＩＣ分增加至
－26747。最后形成的隐结构模型结构图如图6所
示。以下称这里的数据为抑郁症数据�称所得到的
模型为抑郁症的隐结构统计模型�简称抑郁症模型。
3．4　
对获得的隐结构模型进行诠释
抑郁症模型中有34个隐变量�每个隐变量代表
一个对数据样本的划分�每个划分由二个或以上的
隐类组成�模型诠释就是从中医角度�把握这些划分
以及各个隐类的含义。
3．5　
探索研究结果的意义和用途
在结合中医理论对抑郁症隐结构中34个隐变
量及相关隐类进行诠释的基础上�进一步探讨这些
内容和结果在中医证候研究中的意义和用途。
4　
抑郁症模型诠释示例
以抑郁症模型中的隐变量Ｙ33为例�示范隐变
量和隐类诠释的方法和步骤。
4．1　
考察隐变量的信息曲线
在抑郁症模型的结构图中（图5）�Ｙ33处于右
下角位置。它有两个取值�所以代表一个将抑郁
症患者分为两类的划分。把Ｙ33的两个状态分别
记为ｓ
0和ｓ
1�而把Ｙ33划分中的两个隐类分别记
为Ｙ33＝ｓ
0与Ｙ33＝ｓ
1。Ｙ33的信息曲线如图6所
示�在图中可见�胸胁胀满情况（Ｘ1）、腹痛情况
（Ｘ2）、胃脘胀满情况（Ｘ3）、胸胁胀痛情况（Ｘ4）
和腹胀情况（Ｘ5）是与Ｙ33关系密切的显变量�它
们对Ｙ33的信息覆盖度达到98％。这表示�胸胁
胀满情况等5个显变量反映出了隐类Ｙ33＝ｓ
0与
隐类Ｙ33＝ｓ
1之间的几乎全部区别。因此�可以
说Ｙ33代表的是一个基于胸胁胀满情况等5个显
变量对抑郁症患者所做的划分。
图6　
抑郁症模型中隐变量Ｙ33的互信息曲线
4．2　
考察隐类的类条件概率分布
图3给出的3个划分都是硬划分�在硬划分中�
一个事物要么属于一个类�要么不属于该类�中间
无第三种可能性。与此不同�隐结构模型中隐变量
所代表的划分是概率软划分�一个事物可能有一定
概率属于某个类�同时也可以有一定概率属于另外
的类。要把握概率软划分中各个类的特点�就需要
考察它们的类条件概率分布。
Ｙ33的两个隐类Ｙ33＝ｓ
0和Ｙ33＝ｓ
1的类条件概
率分布见表2。“Ｐ（Ｘ＝1｜Ｙ33＝ｓ
0）”是在隐类Ｙ33＝
ｓ
0中�某显变量Ｘ取值为“1”（即症状出现）的概
率；而“Ｐ（Ｘ＝1｜Ｙ33＝ｓ
1）”是在隐类Ｙ33＝ｓ
1中�显
变量Ｘ取值为“1”的概率�表中显变量的选择基于
Ｙ33的互信息曲线图。通过分析�发现两个隐类的主
要区别在于：所有5个症状在Ｙ33＝ｓ
1中出现的概率
均较高�而在Ｙ33＝ｓ
0中�胸胁胀满（Ｘ1）、腹痛
（Ｘ2）、胸胁胀痛（Ｘ4）这3个症状出现的概率几乎为
0；胃脘胀满（Ｘ3）、腹胀（Ｘ5）这2个症状有一定出现
概率。因此�隐变量Ｙ33是基于胸胁胀满情况等5个
显变量把抑郁症患者划分为两大类。
·523·
第8期
王天芳等　
隐结构模型及其在中医证候研究中的应用
·524·
　
　
　
　
　
　
　
　
　
　
　
　
　
　
　
　
第32卷
表2　
隐类Ｙ33＝ｓ
0和Ｙ33＝ｓ
1的隐类条件类概率分布
Ｘ
Ｐ（Ｘ＝1｜Ｙ33＝ｓ
0）
Ｐ（Ｘ＝1｜Ｙ33＝ｓ
1）
Ｘ1
0．06
0．57
Ｘ2
0．02
0．41
Ｘ3
0．29
0．80
Ｘ4
0．01
0．32
Ｘ5
0．23
0．66
4．3　
结合中医理论进行诠释
根据中医的辨证学理论一般认为：①胃脘胀满
提示病变部位在胃�属胃脘气滞的表现。导致胃脘
气滞的原因有多种�如痰、饮、水、湿、宿食、寒、热等
邪气停滞于胃�或胃的阳气不足�均可导致胃中气机
的郁滞不畅而出现胀满。②腹胀提示病变部位多在
脾�也可能在大肠、肝等�是各种原因�如阳气不足�
或各种邪气内阻影响腹部气机运行不畅所致。③胸
胁胀满和胸胁胀痛提示病变部位多在肝、胆�常见于
气滞、湿热、热邪等邪气阻碍肝、胆气机疏泄所致。
④腹痛提示病变部位多在脾�也可能在大肠、肝等�
常因各种虚�如阳虚、气虚等和实如气滞、寒凝、瘀血
等因素引起局部气血阻滞所致。
每个隐变量都有两个密不可分的方面�一方面
它代表一个划分�另一方面它代表划分产生的机制。
作为产生划分的一个机制�Ｙ33与上述5个症状变量
密切相关。根据中医知识�初步认为导致这5个症
状出现的机制最有可能是脾胃气滞、肝郁气结（或
肝、脾胃不和）。由于脾胃气滞、肝郁气结的症状特
征�除上述5个症状以外�还有许多其他方面。所以
可以认为�Ｙ33这个划分机制是脾胃气滞、肝气郁结
的一个侧面。
综合前面讨论的内容�可以认为�Ｙ33是基于胸
胁胀满情况等5个显变量把病例样本划分为两个
类�这个划分是脾胃气滞、肝郁气结一个侧面在症状
上的反映。划分中的Ｙ33＝ｓ
1这个类表现出脾胃气
滞、肝郁气结表现的概率较高�而另一个类Ｙ33＝ｓ
0
则很少表现出肝气郁结的症状�但有一定的概率表
现出脾胃气滞的症状。从Ｙ33所反映的病机层面
看�病位在脾、胃与肝（可以理解为构成证候的病位
类证候要素）�直接相关的病性为气滞（可以理解为
构成证候的病性类证候要素）。
5　
讨论
一个隐变量代表一个划分�划分由两个或以上
隐类组成。对一个隐变量进行诠释�首先基于信息
曲线�考察哪些显变量与该隐变量关系密切以及它
们信息覆盖度的高低�从而明确划分中各个类之间
的区别主要在哪些方面；其次考察各个隐类的条件
概率分布�把握各个隐类的特点；最后结合中医专业
知识�确定隐变量和隐类的中医学含义。在这个过
程中�每一步都需要主观判断�存在一定主观性。但
是�隐结构模型分析的结果是在客观临床调查数据
基础上�由计算机在统计学原则指导下自动搜索而
产生的�不是某一个人或几个人的经验�反映的是数
据共性特征�因此具有较强的客观性。虽然对这些
结果的诠释难以避免的会受主观因素影响�但它们
对中医的研究还是很有意义的�主要有以下几方面。
第一�它能显示中医证候／病机的客观性。隐结
构法的基本思想是�在统计学原则的指导下�寻找多
个角度�对未经医生辨证的病例数据进行多维聚类
分析�或者说多维划分。所得到的每一个划分都是
数据在某一方面特征的反映�具有客观性。如果划
分所反映的特征是某个证候／病机的特征�那么就说
明该证候／病机具有客观性。例如�在抑郁症模型中
隐变量Ｙ33代表的是一个主要依据胸胁胀满等5个
症状对样本数据的划分。根据中医辨证学理论�这
种划分所的特征可以认为是脾胃气滞、肝郁气结证
（或肝、脾胃不和）的一个侧面。由于该划分的依
据�来源于对一定样本的抑郁症的客观症状数据的
分析�因此�体现了脾胃气滞和肝郁气结的客观存在
性。需要指出的是�并不是所有隐变量所反映出来
的数据特征都有中医意义。
第二�通过分析模型中具有中医辨证意义的隐
变量或隐类可能涉及的证候及证候要素�为提取该
疾病的常见证候及证候要素提供依据。
第三�通过运用模型中的数学信息分析一些隐
变量与其所含显变量（症状）的关系�可以了解症状
对于相应证候或证候要素的贡献度�从而为建立证
候或证候要素的诊断标准提供依据。
总之将隐结构法用于中医证候的研究�是由张
氏等
［1－5］于2006年首先提出的。本文系统阐述了
关于隐结构法的目的、原理、步骤、结果诠释及意义
方面的最新认识和进展。包括以下几个方面：①在
以往主要强调隐结构概念的基础上�进一步明确了
隐结构和多维划分在隐结构法中是两个不可分割的
支柱。②更加明确了隐结构法的目的�即是基于数
据特征�从多个角度对患者人群进行划分�从而为证
候的规范化、标准化研究提供较为客观的依据。
③在隐树分析算法方面有重要进展�而且研发了对
树状模型进行加边的算法�从而摆脱了树状模型的
限制。④从划分角度出发�深入探讨了隐结构模型
·525·
第8期
王天芳等　
隐结构模型及其在中医证候研究中的应用
的诠释�使得现在可以准确地把握隐变量和隐类的
含义。⑤本文通过一项具体研究实例�为读者使用
隐结构法提供了一个范例。
